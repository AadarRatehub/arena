<h2>Queue <code>{{ queueHost }}/{{ queueName }}</code></h2>

<h3>Total {{capitalize state}} Jobs</h3>

<div class="input-group">
  <span class="input-group-btn">
         <button id="btnFilter" name="btnFilter" type="button" class="btn btn-success">
                Filter
         </button>
      </span>
    <input type="text" class="form-control" id="filter" name="filter" placeholder="fieldname === value" value="{{ jobFilter }}">
      <span class="input-group-btn">
    <button id="btnClear" name="btnClear" type="button" class="btn btn-danger">
                Clear
         </button>
  </span>
</div>
<p>Displaying {{jobs.length}} {{ capitalize state}} Jobs</p>

<div class="row pagination-container">
  <div class="col-sm-6">
    <a href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}.json" type="button"
      class="btn btn-primary">
      Dump jobs to JSON (limited to 1000)
    </a>
    <button type="button" data-action="remove" data-queue-name="{{ queueName }}" data-queue-host="{{ queueHost }}"
      data-queue-state="{{ state }}" class="js-bulk-action btn btn-danger">
      Remove Jobs
    </button>
    {{#unless disableRetry}}
    <button type="button" data-action="retry" data-queue-name="{{ queueName }}" data-queue-host="{{ queueHost }}"
      data-queue-state="{{ state }}" class="js-bulk-action btn btn-success">
      Retry Jobs
    </button>
    {{/unless}}
    {{#unless disablePromote}}
    <button type="button" data-action="promote" data-queue-name="{{ queueName }}" data-queue-host="{{ queueHost }}"
      data-queue-state="{{ state }}" class="js-bulk-action btn btn-success">
      Promote Jobs
    </button>
    {{/unless}}

    <div class="btn-group">
      <div class="btn-group">
        <div class="dropdown">
          {{#if disablePagination}}
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            Size <span class="caret"></span>
          </button>
          {{else}}
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            Page Size <span class="caret"></span>
          </button>
          {{/if}}
          <ul class="dropdown-menu">
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}<&amp;pageSize={{ pageSize }}&filter={{ jobFilter }}">{{ pageSize }}
                jobs</a></li>
            <li role="separator" class="divider"></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}&amp;pageSize=5&filter={{ jobFilter }}">5
                jobs</a></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}&amp;pageSize=20&filter={{ jobFilter }}">20
                jobs</a></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}&amp;pageSize=100&filter={{ jobFilter }}">100
                jobs</a></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}&amp;pageSize=1000&filter={{ jobFilter }}">1000
                jobs</a></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}<&amp;order={{ order }}&amp;pageSize={{ numJobs }}&filter={{ jobFilter }}">Total
                jobs</a></li>
          </ul>
        </div>
      </div>
      {{#unless disableOrdering}}
      <div class="btn-group">
        <div class="dropdown">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            Order <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}&amp;pageSize={{ pageSize }}&amp;order={{ order }}">{{ order }}
              </a></li>
            <li role="separator" class="divider"></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}&amp;pageSize={{ pageSize }}&amp;order=asc">acs
              </a></li>
            <li><a
                href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage }}&amp;pageSize={{ pageSize }}&amp;order=desc">desc
              </a></li>
          </ul>
        </div>
      </div>
      {{/unless}}
    </div>
  </div>
</div>


<div class="row">
  <div class="col-sm-12">
    <form class="js-bulk-job-form">
      <ul class="list-group">
        <li class="list-group-item">
          <input class="js-select-all-jobs" type="checkbox" />
          <h5 class="header-collapse select-all-text">Select All</h5>
        </li>

        {{#each jobs}}
        <li class="list-group-item">
          <div class="js-bulk-action-container bulk-job-container">
            <input type="hidden" name="jobId" value="{{ this.id }}" />
            <input class="js-bulk-job" name="jobChecked" type="checkbox" />
          </div>

          <a role="button" data-toggle="collapse" href="#collapse{{hashIdAttr this}}">
            <h4 class="header-collapse">
              <span class="label label-default">{{#if this.id}}{{ this.id }}{{else}}<em>missing id</em>{{/if}}</span>
              {{#if this.data.arenaName}}
              <span style="margin-left: 8px">{{ this.data.arenaName }}</span>
              {{else if this.name}}
              <span style="margin-left: 8px">{{ this.name }}</span>
              {{else if this.data.name}}
              <span style="margin-left: 8px">{{ this.data.name }}</span>
              {{/if}}
            </h4>
          </a>
          <div id="collapse{{hashIdAttr this}}" class="collapse">
            {{~> dashboard/jobDetails this basePath=../basePath displayJobInline=true queueName=../queueName queueHost=../queueHost jobState=../state }}
          </div>
        </li>
        {{/each}}
      </ul>
    </form>
  </div>
</div>

<p>
  <em>Hint: </em><kbd><span style="font-family: sans-serif;">&#8679;</span> + Click</kbd><em> to select a range of
    jobs.</em>
</p>

{{#contentFor 'sidebar'}}
<li><a href="{{ basePath }}/">Queues Overview</a></li>
<li><a href="{{ basePath }}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}">Queue
    <code>{{ queueHost }}/{{ queueName }}</code></a></li>
<li class="active"><a href="#">{{capitalize state}} Jobs</a></li>
{{#if hasFlows}}
<li><a href="{{ basePath }}/flows/">Flows Overview</a></li>
{{/if}}
{{/contentFor}}
{{#contentFor 'script'}}
        $(document).ready(function() {
            $("#btnFilter").click(function () {
                let _filter = $('#filter').val();
                $(location).attr('href', '{{basePath}}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage  }}&pageSize={{ pageSize }}' + '&filter=' + _filter);
            });
            $("#btnClear").click(function () {
                $(location).attr('href', '{{basePath}}/{{ encodeURI queueHost }}/{{ encodeURI queueName }}/{{ state }}?page={{ currentPage  }}&pageSize={{ pageSize }}');
            });
        });
{{/contentFor}}